![[Pasted image 20251206234936.png]]

---

## **1. 时钟与控制相关参数**

### **Clock transition on which the bit capture is made**​

**含义**：**数据位捕获的时钟边沿**​

**值**：`Rising transition`（上升沿）

**说明**：

- 选择SDIO时钟（SDIO_CK）的哪个边沿用于采样（捕获）数据线上的数据。
    
- 可选值通常有**上升沿**（Rising）或**下降沿**（Falling），也可能支持两者（双沿模式，但SDIO通常不常用）。
    
- **上升沿**是最常见、最稳定的配置，与SD卡标准兼容性好。
    

---

### **SDIO Clock divider bypass**​

**含义**：**时钟分频器旁路**​

**值**：`Disable`（禁用）

**说明**：

- 如果启用（Enable），会**绕过内部时钟分频器**，SDIO_CK时钟直接等于输入时钟（如48MHz的PLL48CK）。
    
- 禁用时，SDIO_CK的频率由下面的**SDIOCLK clock divide factor**分频系数决定。
    
- 通常**禁用**，以便通过分频系数灵活调节SD卡时钟频率。
    

---

### **SDIO Clock output enable when the bus is idle**​

**含义**：**总线空闲时是否输出时钟**​

**值**：`Disable`（禁用）

**说明**：

- 如果启用，即使总线空闲（无数据传输），SDIO_CK时钟信号仍会持续输出到SD卡。
    
- 禁用时，空闲期间停止输出时钟，可**降低功耗**，但某些旧款SD卡可能需要持续时钟以保持状态。
    
- 现代SD卡一般支持空闲时停钟，因此通常**禁用**以省电。
    

---

### **SDIOCLK clock divide factor**​

**含义**：**SDIOCLK时钟分频系数**​

**值**：`0`

**说明**：

- 这是配置**SDIO_CK输出频率**的关键参数。
    
- 公式为：**SDIO_CK频率 = SDIOCLK输入频率 / （2 + 分频系数）**。
    
- 输入频率SDIOCLK通常为**48MHz**（来自PLL48CK）。
    
- 当分频系数 = 0 时，SDIO_CK = 48MHz / (2+0) = **24MHz**。
    
- 这是SD卡的**初始识别频率**（低速模式），初始化后可提高频率（如24MHz或更高，取决于卡支持）。
    

---

## **2. 高级控制参数**

### **SDIO hardware flow control**​

**含义**：**SDIO硬件流控制**​

**值**：`The hardware control flow is disabled`（禁用硬件流控制）

**说明**：

- 如果启用，SDIO控制器会使用**FIFO就绪信号**来控制数据传输，防止缓冲区溢出。
    
- 禁用时，依赖软件控制数据流。
    
- 在**高速模式**（如4位总线、高频率）下建议启用，可提高数据传输的稳定性，避免丢失数据。
    
- 当前配置为禁用，适合低速或简单应用。
    

---

## **参数配置总结**

|参数|当前值|含义与建议|
|---|---|---|
|时钟捕获边沿|上升沿|标准配置，兼容性好|
|分频器旁路|禁用|使用分频器调节频率|
|空闲时钟输出|禁用|省电模式|
|硬件流控制|禁用|适合低速应用，高速时建议启用|
|时钟分频系数|0|输出时钟24MHz（初始频率）|

---

## **实际应用建议**

1. **初始化阶段**：
    
    - 使用**24MHz**（分频系数0）识别和初始化SD卡。
        
    - 识别后可根据卡的支持能力提高频率（如调整分频系数为1，得到16MHz等）。
        
    
2. **高速传输**：
    
    - 如果使用SDHC/SDXC卡或需要高速度（>25MHz），建议：
        
        - 启用**硬件流控制**。
            
        - 根据卡版本设置合适频率（最高可达48MHz，分频系数需相应计算）。
            
        
    
3. **功耗优化**：
    
    - 保持“空闲时钟输出”为**禁用**，以降低功耗，尤其对电池供电设备。
        
    
4. **稳定性**：
    
    - 多数应用保持“上升沿捕获”和“禁用分频器旁路”即可。
        
    

如果你需要**修改配置**（如提高速度、启用硬件流控制），可以调整对应参数，并注意**SD卡规格支持**（Class等级、UHS模式等）。