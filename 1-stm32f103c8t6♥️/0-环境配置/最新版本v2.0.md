# stm32环境配置v2.0

## 需要的工具

1. vscode 
2. cmake 
3. ninja 
4. arm-none-eabi-gcc
5. openocd
6. (可选)ubuntu(操作系统)/Windows(操作系统)
7. (可选)clangd(代码提示)


## 使用CubeMX生成项目进行开发

之前我的做法是自己用已有的项目开发，驱动库都是已经弄好的，但是这样很不好，主要是要用一个新的外设就非常的麻烦，要配置老半天才能进行开发。但是有了CubeMX之后，我就只需要点两下就可以快速上手项目，还是很爽的。

用CubeMX配置好项目之后，`CTRL+S`保存项目文件，选择一个你喜欢的path，然后选择Toolchain为CMake

![[Pasted image 20251109020358.png]]


然后右上角的，生成代码，就可以很方便的生成项目

![[Pasted image 20251109162926.png]]



## 在VSCode编译

然后用VScode打开项目就好了

怎么编译项目呢？

在根目录下面输入

```sh
cmake --preset Release
```

然后，把

就可以配置好cmake项目，怎么编译呢？

也只需要在根目录下面输入

```cmake
cmake --build --preset Release
```

然后就去`build/Release`目录下面找.elf文件就好了

或者点击VSCode左下角的build按钮就好了

![[Pasted image 20251109163510.png]]


## 烧录

怎么烧录文件呢？我这里用的是openocd。推荐你写一个脚本，然后名字叫`run`，在里面写上下面的内容

```sh
#!/usr/bin/bash
openocd -f interface/stlink-v2.cfg -f target/stm32f1x.cfg -c "program firmware.elf verify reset exit"
```

然后在改一下这个文件为可运行文件

```sh
chmod +x ./run
```


## 参考资料

1. [[1-stm32f103c8t6♥️/1-教程/4-ADC读取PWM/essay]]
2. 

