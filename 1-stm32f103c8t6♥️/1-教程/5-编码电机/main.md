# 编码电机

编码电机比普通的电机，多了一个部分，就是霍尔元件，他可以用于测量电机当前的转速，甚至姿态。主要原理就是电机转动的时候，带动磁铁，然后让霍尔元件去切割磁感线，每切割一次磁感线，就发出一次脉冲。

利用这个原理，我们就可以去测量小车的速度了。

## cubemx配置项目

### 起手式

不再赘述

### 配置编码器

选择Combined Channelds 为Encoder Mode，然后注意了，选择Encoder Mode为 TI1和TI2 两个一起的阿，不要只选择触发一个的。然后设置两个Input Filter都设置为15（设置较低的值，相应速度更快一点，不过没关系了，设置为6也行）

![[Pasted image 20251106130049.png]]

### 配置PWM

这部分不再赘述

### 配置GPIO

这部分不再赘述


## 测量电机速度

我的电机是JGA25-370编码电机，减速比是1：30，编码器是12线的，稍微计算一下，发现电机转一圈大概是1440 = 30 * 12 * 4(四分频)，根据这个信息，我们就可以很方便的得出小车的速度

$$
v_{\text{car}} = \frac{d\ \text{pos}}{1440 \cdot dt}
$$




## 参考资料

1. https://blog.csdn.net/Xiaoxuexxxxx/article/details/137937083
2. [[1-stm32f103c8t6♥️/1-教程/4-ADC读取PWM/essay]]
3. [[1-stm32f103c8t6♥️/1-教程/2-USART通信/essay]]
4. [[1-stm32f103c8t6♥️/1-教程/1-点亮自带的LED/index]]