
```python
import matplotlib.pyplot as plt
import matplotlib.animation as animation
import numpy as np
from collections import deque

# 使用双端队列存储数据，自动限制数据量
max_points = 100
x_data = deque(maxlen=max_points)
y_data = deque(maxlen=max_points)

# fig是图框，ax是画布
fig, ax = plt.subplots(figsize=(12, 6))
# 改变fig的窗口title
fig.canvas.manager.set_window_title("我的PID仿真台爽了")
line, = ax.plot([], [], 'r-', linewidth=2)
# 显示网格
ax.grid(True, alpha=0.3)

ax.set_xlabel('timestamp')
ax.set_ylabel('sensor data')
ax.set_title('real-time sensor')

def init():
    line.set_data([], [])
    return line,

def update_ticks(x_min, x_max):
    """智能更新x轴刻度"""
    x_range = x_max - x_min
    
    # 根据x轴范围动态设置刻度间隔
    if x_range <= 20:
        tick_interval = 2
    elif x_range <= 50:
        tick_interval = 5
    elif x_range <= 100:
        tick_interval = 10
    elif x_range <= 200:
        tick_interval = 20
    else:
        tick_interval = 50
    
    # 设置主要刻度
    ax.xaxis.set_major_locator(plt.MultipleLocator(tick_interval))
    
    # 添加次要刻度（可选）
    if tick_interval >= 5:
        ax.xaxis.set_minor_locator(plt.MultipleLocator(tick_interval/2))
    
    # 设置刻度标签样式
    ax.tick_params(axis='x', which='major', labelsize=9)
    ax.tick_params(axis='x', which='minor', labelsize=6)

def update_y_ticks(y_min, y_max):
    """智能更新y轴刻度"""
    y_range = y_max - y_min
    
    # 根据y轴范围动态设置刻度间隔
    if y_range <= 2:
        tick_interval = 0.5
    elif y_range <= 5:
        tick_interval = 1
    elif y_range <= 10:
        tick_interval = 2
    else:
        tick_interval = 5
    
    # 设置y轴主要刻度
    ax.yaxis.set_major_locator(plt.MultipleLocator(tick_interval))
    
    # 添加y轴次要刻度
    if tick_interval >= 1:
        ax.yaxis.set_minor_locator(plt.MultipleLocator(tick_interval/2))

def animate(frame):
    # 模拟实时数据（实际应用中替换为真实数据源）
    x = frame
    y = np.sin(frame * 0.1)  # + 0.1 * np.random.randn()  # 添加噪声
    
    x_data.append(x)
    y_data.append(y)
    
    line.set_data(x_data, y_data)
    
    # 动态调整坐标轴范围
    if len(x_data) > 1:
        x_min = max(0, x_data[0])
        x_max = x_data[-1] + 10
        y_min = min(y_data) - 0.5
        y_max = max(y_data) + 0.5
        
        ax.set_xlim(x_min, x_max)
        ax.set_ylim(y_min, y_max)
        
        # 更新刻度
        update_ticks(x_min, x_max)
        update_y_ticks(y_min, y_max)
        
        # 实时更新标题显示信息
        ax.set_title(f'real-time sensor - Frame: {frame}, Current: {y:.3f}', fontsize=12)
    
    return line,

# 创建动画
ani = animation.FuncAnimation(
    fig, animate, init_func=init,
    interval=100, blit=False, save_count=50
)

plt.tight_layout()
plt.show()
```


## 吐槽一下blit参数(FuncAnimation)

这个是用来优化显示的，如果改为True，意思就是说，只更新修改后的部分。但是这有点bug，就是在绘制实时数据的时候，居然，居然不会更新刻度？？？这我就生气了，后面改成False就好了

还有，这个