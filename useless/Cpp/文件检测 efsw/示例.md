# 示例

## 编译

这边以Linux环境为基础了（主要是Linux方便对把）

去github上去下载源代码（clone也可以，我是直接加速器下载的）， https://github.com/SpartanJ/efsw ，然后下载完后，解压文件，进入文件夹，创建一个build文件夹，在这个build文件夹中执行命令`sudo make install`，如果你要使用动态链接库，那么还需要更新以下动态链接库的缓存`sudo ldconfig`，然后才可以使用efsw的动态链接库，要不然会报错。

efsw，有两个链接库，一个是动态链接库（efsw），一个是静态链接库（efsw-static），推荐安装静态库，省的别人安装efsw库了。

## 示例代码

```cpp
#include <efsw/efsw.hpp>
#include <iostream>

class Listener : public efsw::FileWatchListener {
public:
    void handleFileAction(efsw::WatchID watchid, const std::string& dir,
                        const std::string& filename, efsw::Action action,
                        std::string oldFilename = "") override {
        switch (action) {
            case efsw::Actions::Add:
                std::cout << "[Created] " << filename << " in " << dir << std::endl;
                break;
            case efsw::Actions::Delete:
                std::cout << "[Deleted] " << filename << " in " << dir << std::endl;
                break;
            case efsw::Actions::Modified:
                std::cout << "[Modified] " << filename << " in " << dir << std::endl;
                break;
            case efsw::Actions::Moved:
                std::cout << "[Moved] " << oldFilename << " -> " << filename << " in " << dir << std::endl;
                break;
            default:
                std::cout << "Unknown action on " << filename << " in " << dir << std::endl;
        }
    }
};

int main(int argc, char** argv) {
    efsw::FileWatcher fileWatcher;
    Listener listener;
    efsw::WatchID watchID = fileWatcher.addWatch("./", &listener, true); // true = recursive

    if (watchID < 0) {
        std::cerr << "Error adding watch for " << "./" << std::endl;
        return 1;
    }

    fileWatcher.watch(); // 开始监控(异步调用）

    for (;;); // 阻塞代码
    
    return 0;
}
```


